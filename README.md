a simple script for v2ex sign

***

一个非常简易的 js 脚本(练习用)，用来完成V2EX每日的自动签到

实现思路是模拟鼠标进行点击完成签到

完成度：80%

后续会对性能进行优化：

* 希望能够达到后台打开自动完成签到的效果

* 可能会引入cookies，24小时后进行判断执行，避免频繁地遍历元素

* 更高效的取对象

* 增强代码健壮性

测试于火狐/水狐浏览器下，Greasemonkey扩展下

今天是第一天，一步步慢慢来

***

把两个脚本合一，但是模拟点击载入新界面后JS脚本需要再度刷新才能进行执行

考虑解决方案中，AJAX是很多人的答案，但是纯粹基于客户端进行修改的，排除这一项

尝试使用window.open解决问题，但是还要考虑浏览器阻拦的问题

最后，需要对第二个函数进行修改，不然就会一直找按钮点击下去233

***

修正了反复点击的问题

引入了cookie，1天后过期，cookie有效期内不对页面元素进行处理

在 **window.onload** 之后的判断应该对用户体验影响不大

貌似一次就解决了问题，具体状况明天再看

另外感谢 **文科** 和 **月月** 的star


![测试截图](http://jimmy66.qiniudn.com/屏幕快照 2015-02-03 下午9.15.50.jpg "测试截图")

***

今天又测试了下，点击进入首页后自动完成了签到

但是也出现了相应的比较怪异的事件就是签到结束后cookie消失了

后续还要优化的三个方面:

* 在已经完成签到但是cookie不存在的情况下，确认签到结束，并且添加cookie
* 在新的标签页完成操作，不影响主界面阅读，签到完成后关闭标签页。最后能实现完全不可见的后台操作
* 检查时增加URL定位，提高精确度，考虑引入正则表达式

然后就是练习使用Git的更多功能了，加了个测试用的branch

不知道JS能实现的最好效果是什么样子的，目前我只是基于自己所想和所知道的思路去编程。

当然最理想的应该还是用Python模拟登陆后进行签到

另外用检查页面元素的方式确认签到状态确实感觉太低效了，更优化地方案是读相应的实现代码，在cookie或者其他方面找到答案吧

***

我真是太2了。。没有考虑V2本身也有其他cookie，修正了cookie的检测

设定  <code> path=/ </code> 这样子在签到页面产生的cookie，在父页面中也能检测到，有效地避免了二次检查

不过加域的设置貌似不太多，看了下，设定混合在一起了。可能是firebug的显示特性吧

***

看了下cookie确实过期消失了，功能设置基本正常，后续进行优化吧

***

验证了下功能，在有cookie的情况下就算可以签到也不会执行脚本

http://jimmy66.qiniudn.com/屏幕快照 2015-02-09 下午9.46.41.jpg

![测试截图2](http://jimmy66.qiniudn.com/屏幕快照 2015-02-09 下午9.46.41.jpg "测试截图2")

搜索了下要想JS后台打开再关闭，难度比较大（浏览器会防止弹窗）

想了下，优化下验证机制后，就算完成了吧

***

准备一段时间后用node.js重写，中间估计会写个Python版本的（另开一个项目），当然填坑时间未知
